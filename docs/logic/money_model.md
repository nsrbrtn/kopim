# Единая модель денег

Цель: уйти от `double` и хранить суммы детерминированно с явной точностью,
поддерживая разные валюты и криптоактивы.

## Базовая модель

`Money` хранит:
- `minor` — целое количество минимальных единиц (BigInt).
- `scale` — число дробных знаков для валюты/актива.
- `currency` — ISO 4217 или тикер (например, `USD`, `RUB`, `BTC`).

Пример:
- `USD` (scale=2): `12.34` => `minor=1234`.
- `JPY` (scale=0): `1200` => `minor=1200`.
- `BTC` (scale=8): `0.00010000` => `minor=10000`.

## Округление

Единое правило: **banker’s rounding (half‑even)** до `scale` при вводе,
импорте и синхронизации.

Все вычисления выполняются в `minor` без `double`.

## Хранение в БД

- Поля денег храним как `*_minor` (целое).
- Для BigInt в Drift использовать `TEXT` (строковое представление).
- `scale` и `currency` хранятся вместе с суммой, если не выводятся однозначно.

## Синк и импорт/экспорт

- В payload использовать `amountMinor` + `currency` (+ `scale`).
- Для backward‑compat: если пришёл `amount` (double), конвертировать в minor.

## UI

UI форматирует `Money` по `currency/scale`.
Ввод — строка, парсинг в `Money` с округлением.
