# Инструкции для ИИ-агентов и ExecPlan

Этот документ описывает, где лежат агентские инструкции и как оформлять ExecPlan для сложных задач.

## Где лежат инструкции

- `AGENTS.md` — быстрый вход, ключевые правила и команды.
- `.agent/PLANS.md` — руководство и шаблон ExecPlan.
- `.agent/workflows/` — пошаговые процедуры для конкретных операций.
- `docs/logic/feature_invariants.md` — инварианты и правила по фичам.

## Когда нужен ExecPlan

ExecPlan обязателен для:

- новых фич или заметных изменений UX/поведения;
- существенных рефакторингов;
- миграций БД/изменений схем Drift/логики синхронизации;
- изменений архитектуры и публичных API;
- производительности в горячих путях.

## Минимальные требования к ExecPlan

- Самодостаточный и проверяемый: понятно, что делаем и как валидируем.
- Живой документ: `Progress` обновляется по мере выполнения.
- Содержит обязательные секции из `.agent/PLANS.md`.

## Документация изменений

Любое изменение поведения должно быть отражено в `docs/`:

- **Что изменилось**, **зачем**, **как проверить**, **breaking changes**.
- **Миграции/схемы:** фиксировать в `docs/logic/` отдельным документом или обновлением существующего (с ссылками на миграции).
- **Изменения UX:** документировать в `docs/components/` (виджеты) или `docs/logic/` (поведение экранов).

Минимальный формат записи:

- Что изменилось:
- Зачем:
- Как проверить:
- Breaking changes:

## Проверка перед сдачей

Минимальный набор команд:

```bash
dart format --set-exit-if-changed .
flutter analyze
dart run build_runner build --delete-conflicting-outputs
flutter test --reporter expanded
```

Если команды не запускаются в окружении — зафиксируй причину и список требований для запуска.
