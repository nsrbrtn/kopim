# настроить мультивалютность в аналитике (в т.ч. для виджета «Остаток денег»): корректно агрегировать доходы/расходы/остаток по валютам или ограничивать выбор счетов одной валютой.

# Идеи улучшения AI Ассистента

### 1. Переход на Tool Use (Function Calling)
#частично выполнен но работает не полностью. 
Сейчас логика работает по схеме: *Парсинг сигналов (RegEx) -> Загрузка данных -> Промпт -> Ответ*.
Это ограничивает ассистента жестко заданными фильтрами (только "текущий месяц", "прошлый месяц" и т.д.).
**Предложение:** Внедрить "Инструменты" (Tools).
ИИ сам будет решать, какие данные запросить. Например, на вопрос *"Сколько я потратил на такси на прошлой неделе?"* он сам вызовет функцию `getTransactions(category: 'Taxi', period: 'last_week')`. Это сделает ассистента намного умнее и гибче.

### 2. Потоковая генерация (Streaming)
В репозитории сейчас используется метод `generateAnswer`, который ждет полного ответа от сервера.
**Предложение:** Переключиться на `streamAnswer` (он уже есть в сервисе). Пользователь будет видеть текст по мере его появления (как в ChatGPT), что существенно снизит ощущение задержки.

### 3. Расширение контекста
Сейчас ассистент видит только:
- Траты по месяцам
- Топ категорий
- Бюджеты
**Предложение:** Добавить в промпт:
- **Повторяющиеся платежи** (чтобы он мог прогнозировать обязательные расходы).
- **Цели накопления** (чтобы давать советы в контексте целей).
- **Сравнение периодов** (тренды, например, "ты стал тратить на еду на 20% больше").

### 4. Структурированный вывод (JSON Mode)
Сейчас ответ — просто текст.
**Предложение:** Заставить модель возвращать JSON, в котором помимо текста будут "Действия". Например, если ассистент советует сократить расходы, он может вернуть кнопку *"Создать бюджет на Продукты"*, которую приложение отрисует в чате.

### 5. Персонализация (System Prompt)
**Предложение:** Дать пользователю выбор "личности" ассистента: "Строгий финансовый советник", "Поддерживающий коуч" или "Лаконичный аналитик".

Developers now have more power when creating pop-ups, dialogs, and other floating UI elements with OverlayPortal. It is now possible to render a child in any Overlay up the widget tree using OverlayPortal.overlayChildLayoutBuilder 
(174239), making it easier to show an app-wide notification or other UI that needs to escape the layout constraints of its parent widget. The underlying Overlay.of method was also made more robust and efficient

For a more modern Android navigation experience, predictive back route transitions are now enabled by default in MaterialApp (173860). When a user performs the back gesture, they now see a preview of the home 
screen as the current route animates away. In addition, the default page transition has been updated to FadeForwardsPageTransitionsBuilder from ZoomPageTransitionsBuilder to reflect native behavior.

An Android-specific bug (171973) has been resolved, primarily affecting Samsung devices with hardware keyboards. Previously, after a user interacted with a TextField, the Android Input Method Editor (IME) could get stuck in a stale state. 
This caused the IME to mistakenly intercept “Enter” or “Space” key presses, preventing non-text widgets like a Checkbox or Radio button from receiving the event. The fix ensures that the InputMethodManager is correctly reset when the text connection closes, clearing the IME’s stale state and restoring predictable hardware keyboard interaction for users.